# Specify the input CSV file path
$inputCSVPath = "C:\Path\to\input.csv"

# Specify the default destination path
$destinationPath = "C:\Destination\"

# Specify the name of the column containing folder paths in the CSV file
$folderPathColumnName = "FolderPath"

# Read the CSV file
$csvData = Import-Csv -Path $inputCSVPath

# Iterate through each row in the CSV data
foreach ($row in $csvData) {
    # Check if the folder path column exists in the CSV data
    if ($row.PSObject.Properties.Name -contains $folderPathColumnName) {
        # Get the folder path from the specified column
        $folderPath = $row.$folderPathColumnName

        # Check if the folder path exists
        if (Test-Path $folderPath -PathType Container) {
            # Get all files in the folder
            $files = Get-ChildItem -Path $folderPath

            # Check if there are files in the folder
            if ($files.Count -gt 0) {
                # Copy each file to the destination path
                foreach ($file in $files) {
                    Copy-Item -Path $file.FullName -Destination $destinationPath -Force
                }
                Write-Host "Files copied from $($folderPath) to $($destinationPath)"
            } else {
                Write-Warning "No files found in folder path: $($folderPath)"
            }
        } else {
            Write-Warning "Folder path $($folderPath) does not exist."
        }
    } else {
        Write-Warning "Folder path column '$folderPathColumnName' not found in the CSV file."
    }
}
