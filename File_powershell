# Define your data table with source and destination folder paths
$dataTable = @(
    @{
        ID = 1
        Description = "Description1"
        JobName = "Job1"
        SourceFolderPath = "C:\SourceFolder1"
        DestinationFolderPath = "C:\DestinationFolder1"
        OutputFileName = "OutputFile1.txt"
        SQL = $true
        Oracle = $false
    },
    @{
        ID = 2
        Description = "Description2"
        JobName = "Job2"
        SourceFolderPath = "C:\SourceFolder2"
        DestinationFolderPath = "C:\DestinationFolder2"
        OutputFileName = "OutputFile2.txt"
        SQL = $false
        Oracle = $true
    }
)

# Function to copy files
function Copy-Files {
    param (
        [string]$sourcePath,
        [string]$destinationPath
    )
    Copy-Item -Path $sourcePath -Destination $destinationPath -Force
}

# Loop through the data table
foreach ($row in $dataTable) {
    $sourceFolderPath = $row.SourceFolderPath
    $outputFileName = $row.OutputFileName
    $sourceFilePath = Join-Path -Path $sourceFolderPath -ChildPath $outputFileName

    # Check if the source folder exists
    if (Test-Path $sourceFolderPath -PathType Container) {
        # Perform file copy
        $destinationFolderPath = $row.DestinationFolderPath
        if (-not (Test-Path $destinationFolderPath -PathType Container)) {
            New-Item -Path $destinationFolderPath -ItemType Directory | Out-Null
        }
        $destinationFilePath = Join-Path -Path $destinationFolderPath -ChildPath $outputFileName
        Copy-Files -sourcePath $sourceFilePath -destinationPath $destinationFilePath

        Write-Host "File copied: $outputFileName"
    } else {
        Write-Host "Source folder not found: $sourceFolderPath"
    }
}
