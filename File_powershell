# Load the Excel interop assembly
Add-Type -AssemblyName Microsoft.Office.Interop.Excel

# Set the path to the Excel file
$excelFilePath = "C:\Path\To\Your\File.xlsx"

# Create a new Excel application
$excel = New-Object -ComObject Excel.Application

# Open the workbook
$workbook = $excel.Workbooks.Open($excelFilePath)

# Select the first worksheet
$worksheet = $workbook.Worksheets.Item(1)

# Find the last row and column with data
$maxRow = $worksheet.UsedRange.Rows.Count
$maxCol = $worksheet.UsedRange.Columns.Count

# Loop through each row in the worksheet
for ($row = 2; $row -le $maxRow; $row++) {
    # Read values from the current row
    $ID = $worksheet.Cells.Item($row, 1).Value2
    $description = $worksheet.Cells.Item($row, 2).Value2
    $Jobname = $worksheet.Cells.Item($row, 3).Value2
    $SourceFolderPath = $worksheet.Cells.Item($row, 4).Value2
    $DestinationFolderPath = $worksheet.Cells.Item($row, 5).Value2
    $OutputFilename = $worksheet.Cells.Item($row, 6).Value2
    $JobStatus = $worksheet.Cells.Item($row, 7).Value2
    $SQL = $worksheet.Cells.Item($row, 8).Value2
    $Oracle = $worksheet.Cells.Item($row, 9).Value2

    # Check if the Job status is "completed"
    if ($JobStatus -eq "completed") {
        # Copy the file from source folder to destination folder
        $sourceFile = Join-Path -Path $SourceFolderPath -ChildPath $OutputFilename
        $destinationFile = Join-Path -Path $DestinationFolderPath -ChildPath $OutputFilename
        Copy-Item -Path $sourceFile -Destination $destinationFile -Force
        Write-Host "File '$OutputFilename' copied from '$SourceFolderPath' to '$DestinationFolderPath'."
    }
}

# Close the workbook and Excel application
$workbook.Close()
$excel.Quit()

# Release COM objects
[System.Runtime.Interopservices.Marshal]::ReleaseComObject($worksheet) | Out-Null
[System.Runtime.Interopservices.Marshal]::ReleaseComObject($workbook) | Out-Null
[System.Runtime.Interopservices.Marshal]::ReleaseComObject($excel) | Out-Null
Remove-Variable excel, workbook, worksheet

# Clear clipboard (if used)
[GC]::Collect()
[GC]::WaitForPendingFinalizers()

Write-Host "Script execution completed."
