# Specify the input CSV file path
$inputCSVPath = "C:\Path\to\input.csv"

# Specify the default destination path
$destinationPath = "C:\Destination\"

# Read the CSV file
$csvData = Import-Csv -Path $inputCSVPath

# Debugging: Display column names
Write-Host "Column names in CSV file:"
$csvData[0].PSObject.Properties.Name

# Check if the required columns exist in the CSV data
if ($csvData[0].PSObject.Properties.Name -contains 'FolderPath' -and $csvData[0].PSObject.Properties.Name -contains 'FileName') {
    # Iterate through each row in the CSV
    foreach ($row in $csvData) {
        $folderPath = $row.FolderPath
        $fileName = $row.FileName

        # Construct the full file path
        $filePath = Join-Path -Path $folderPath -ChildPath $fileName

        # Check if the file exists
        if (Test-Path $filePath -PathType Leaf) {
            # Copy the file to the destination path
            Copy-Item -Path $filePath -Destination $destinationPath -Force
            Write-Host "File $($fileName) copied from $($folderPath) to $($destinationPath)"
        } else {
            Write-Warning "File $($fileName) does not exist in folder path: $($folderPath)"
        }
    }
} else {
    Write-Warning "Required columns 'FolderPath' and/or 'FileName' not found in the CSV file."
}
