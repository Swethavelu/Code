# Specify the input CSV file path
$inputCSVPath = "C:\Path\to\input.csv"

# Specify the default destination path
$destinationPath = "C:\Destination\"

# Read the CSV file
$csvData = Import-Csv -Path $inputCSVPath

# Debugging: Display column names
Write-Host "Column names in CSV file:"
$csvData[0].PSObject.Properties.Name

# Check if the 'FolderPath' column exists in the CSV data
if ($csvData[0].PSObject.Properties.Name -contains 'FolderPath') {
    # Get the folder paths from the 'FolderPath' column
    $folderPaths = $csvData | Select-Object -ExpandProperty FolderPath

    # Debugging: Display folder paths
    Write-Host "Folder paths:"
    $folderPaths

    # Iterate through each folder path
    foreach ($folderPath in $folderPaths) {
        # Check if the folder path exists
        if (Test-Path $folderPath -PathType Container) {
            # Get all files in the folder
            $files = Get-ChildItem -Path $folderPath

            # Check if there are files in the folder
            if ($files.Count -gt 0) {
                # Copy each file to the destination path
                foreach ($file in $files) {
                    Copy-Item -Path $file.FullName -Destination $destinationPath -Force
                }
                Write-Host "Files copied from $($folderPath) to $($destinationPath)"
            } else {
                Write-Warning "No files found in folder path: $($folderPath)"
            }
        } else {
            Write-Warning "Folder path $($folderPath) does not exist."
        }
    }
} else {
    Write-Warning "Column 'FolderPath' not found in the CSV file."
}
