# Import the Import-Excel module
Import-Module Import-Excel

# Specify the input Excel file path
$inputExcelPath = "C:\Path\to\input.xlsx"

# Specify the default destination path
$destinationPath = "C:\Destination\"

# Specify the name of the column containing folder paths in the Excel file
$folderPathColumnName = "FolderPath"

# Read the Excel file
$excelData = Import-Excel -Path $inputExcelPath

# Iterate through each row in the Excel data
foreach ($row in $excelData) {
    # Get the folder path from the specified column
    $folderPath = $row.$folderPathColumnName
    
    # Check if the folder path exists
    if (Test-Path $folderPath -PathType Container) {
        # Get all files in the folder
        $files = Get-ChildItem -Path $folderPath
        
        # Copy each file to the destination path
        foreach ($file in $files) {
            Copy-Item -Path $file.FullName -Destination $destinationPath -Force
        }
        Write-Host "Files copied from $($folderPath) to $($destinationPath)"
    } else {
        Write-Warning "Folder path $($folderPath) does not exist."
    }
}
