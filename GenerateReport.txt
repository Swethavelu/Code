# Function to generate HTML table from file comparison result
function Generate-ComparisonHTMLTable {
    param (
        [array]$filesFolder1,
        [array]$filesFolder2
    )

    $htmlTable = "<h2>File Comparison Report</h2>"
    $htmlTable += "<table border='1'><tr><th>File Path</th><th>Size Folder 1 (KB)</th><th>Size Folder 2 (KB)</th><th>Result</th></tr>"

    foreach ($file1 in $filesFolder1) {
        $matchingFile = $filesFolder2 | Where-Object { $_.Name -eq $file1.Name -and $_.Length -eq $file1.Length }

        $sizeInKB1 = [math]::Ceiling($file1.Length / 1KB)
        $sizeInKB2 = if ($matchingFile) { [math]::Ceiling($matchingFile.Length / 1KB) } else { "N/A" }

        $result = if ($matchingFile) { "Matching" } else { "Not Matching" }

        $htmlTable += "<tr><td>$($file1.FullName)</td><td>$sizeInKB1 KB</td><td>$sizeInKB2</td><td>$result</td></tr>"
    }

    $htmlTable += "</table>"
    return $htmlTable
}

# Folder paths
$folder1 = "C:\Path\To\Folder1"
$folder2 = "C:\Path\To\Folder2"

# Fetch file information from both folders
$filesFolder1 = Get-ChildItem -Path $folder1 -Recurse
$filesFolder2 = Get-ChildItem -Path $folder2 -Recurse

# Generate HTML table for file comparison
$htmlComparisonTable = Generate-ComparisonHTMLTable -filesFolder1 $filesFolder1 -filesFolder2 $filesFolder2

# Generate HTML report
$htmlReport = @"
<!DOCTYPE html>
<html>
<head>
    <title>File Comparison Report</title>
</head>
<body>
    $htmlComparisonTable
</body>
</html>
"@

# Save HTML report to a file
$htmlReport | Out-File -FilePath "C:\Path\To\Your\ComparisonReport.html" -Encoding UTF8

# Display success message
Write-Host "Comparison report generated successfully at C:\Path\To\Your\ComparisonReport.html"
