# Define the path to the CSV file
$csvFilePath = "C:\path\to\your\file.csv"

# Import the CSV data
$data = Import-Csv -Path $csvFilePath

# Loop through each row in the CSV
foreach ($row in $data) {
    # Check if the JobStatus is Completed
    if ($row.JobStatus -eq "Completed") {
        # Determine the source and destination paths based on the type
        $sourcePath = $row.SourceFolderPath
        $destinationPath = $row.DestinationFolderPath
        $fileName = $row.FileName

        # Construct the full source and destination file paths
        $sourceFile = Join-Path -Path $sourcePath -ChildPath $fileName
        $destinationFile = Join-Path -Path $destinationPath -ChildPath $fileName

        # Check if the source file exists
        if (Test-Path -Path $sourceFile) {
            try {
                # Copy the file to the destination folder
                Copy-Item -Path $sourceFile -Destination $destinationFile -Force
                Write-Output "Copied $sourceFile to $destinationFile"
            } catch {
                Write-Error "Failed to copy $sourceFile to $destinationFile: $_"
            }
        } else {
            Write-Warning "$sourceFile does not exist."
        }
    }
}
